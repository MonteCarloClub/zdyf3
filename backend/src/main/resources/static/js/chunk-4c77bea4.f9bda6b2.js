(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c77bea4"],{"2bbb":function(e,t,i){},a969:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"content"},[i("div",{staticClass:"wer"},[i("div",{staticClass:"wer-left"},[i("el-input",{attrs:{placeholder:"设备名称"},model:{value:e.searchInput,callback:function(t){e.searchInput=t},expression:"searchInput"}})],1),i("div",[i("el-button",{on:{click:e.searchCert}},[e._v(" 查询证书 ")]),i("el-button",{attrs:{type:"success"},on:{click:function(t){e.applyFormVisible=!0}}},[e._v(" 证书申请 ")])],1)]),i("el-table",{attrs:{data:e.certificates,"empty-text":e.emptyText}},[i("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"设备名称",prop:"ABSUID"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"证书序号",prop:"serialNumber"}}),i("el-table-column",{attrs:{label:"操作",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(i){return e.revoke(t)}}},[e._v(" 撤销证书 ")]),i("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(i){return e.detailInfo(t.row)}}},[e._v(" 详细信息 ")])]}}])})],1),i("el-dialog",{attrs:{title:"详细信息",visible:e.detailVisible},on:{"update:visible":function(t){e.detailVisible=t}}},[i("el-descriptions",{attrs:{column:1}},[i("el-descriptions-item",{attrs:{label:"版本"}},[e._v(e._s(e.detail.version))]),i("el-descriptions-item",{attrs:{label:"设备"}},[e._v(e._s(e.detail.ABSUID)+" ")]),i("el-descriptions-item",{attrs:{label:"证书序号"}},[e._v(" "+e._s(e.detail.serialNumber)+" ")]),i("el-descriptions-item",{attrs:{label:"标签"}},[e._v(" "+e._s(e.detail.ABSAttribute)+" ")]),i("el-descriptions-item",{attrs:{label:"签名人"}},[e._v(e._s(e.detail.issuer))]),i("el-descriptions-item",{attrs:{label:"签名"}},[e._v(e._s(e.detail.signatureName))]),i("el-descriptions-item",{attrs:{label:"优先级"}},[e._v(e._s(e.detail.validityPeriod))])],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.detailVisible=!1}}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"证书申请",visible:e.applyFormVisible},on:{"update:visible":function(t){e.applyFormVisible=t}}},[i("el-form",{ref:"applyForm",attrs:{rules:e.applyRules,model:e.applyCert,"label-width":"80px"}},[i("el-form-item",{attrs:{prop:"uid",label:"UID"}},[i("el-input",{model:{value:e.applyCert.uid,callback:function(t){e.$set(e.applyCert,"uid",t)},expression:"applyCert.uid"}})],1),i("el-form-item",{attrs:{prop:"attribute",label:"标签"}},[i("el-input",{model:{value:e.applyCert.attribute,callback:function(t){e.$set(e.applyCert,"attribute",t)},expression:"applyCert.attribute"}})],1),e.applyRes?i("div",[i("el-form-item",{attrs:{size:"mini",label:"版本"}},[e._v(e._s(e.applyRes.version))]),i("el-form-item",{attrs:{size:"mini",label:"设备"}},[e._v(e._s(e.applyRes.ABSUID)+" ")]),i("el-form-item",{attrs:{size:"mini",label:"证书序号"}},[e._v(" "+e._s(e.applyRes.serialNumber)+" ")]),i("el-form-item",{attrs:{size:"mini",label:"标签"}},[e._v(" "+e._s(e.applyRes.ABSAttribute)+" ")]),i("el-form-item",{attrs:{size:"mini",label:"签名人"}},[e._v(e._s(e.applyRes.issuer))]),i("el-form-item",{attrs:{size:"mini",label:"签名"}},[e._v(e._s(e.applyRes.signatureName))]),i("el-form-item",{attrs:{size:"mini",label:"优先级"}},[e._v(e._s(e.applyRes.validityPeriod))])],1):e._e()],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.applyFormVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.applyForCert}},[e._v("申 请")])],1)],1)],1)},r=[],s=(i("2646"),i("fb4a"),i("0721"),i("4f14")),l=i.n(s),n="/dpki/",o=l.a.create({baseURL:n});o.interceptors.request.use((function(e){return e.headers["Access-Control-Allow-Origin"]="*",e.headers["Access-Control-Allow-Methods"]="GET, POST, PATCH, PUT, DELETE, OPTIONS",e.headers["Access-Control-Allow-Headers"]="Origin, Content-Type, X-Auth-Token",e.crossdomain=!0,e}),(function(e){return console.log("[request error]",e),Promise.reject(e)}));var c={list:function(){return new Promise((function(e,t){o.request({url:"/IoTDevTest",method:"get"}).then((function(i){200===i.status?e(i.data):t(i)})).catch(t)}))},revoke:function(e){var t=e.no;return new Promise((function(e,i){o.request({url:"/RevokeABSCertificate",method:"get",params:{no:t}}).then((function(t){200===t.status?e(t.data):i(t)})).catch(i)}))},certInfo:function(e){return new Promise((function(t,i){o.request({url:"/GetCertificateByUID",method:"get",params:{uid:e}}).then((function(e){200===e.status?t(e.data):i(e)})).catch(i)}))},apply:function(e,t){return new Promise((function(i,a){o.request({url:"/ApplyForABSCertificate",method:"get",params:{uid:e,attribute:t}}).then((function(e){200===e.status?i(e.data):a(e)})).catch(a)}))}},u={name:"List",components:{},data:function(){return{certificates:[],emptyText:"暂无数据",detailVisible:!1,detail:{},applyFormVisible:!1,applyCert:{},applyRules:{uid:[{required:!0,trigger:"blur",message:"UID 不能为空"}],attribute:[{required:!0,trigger:"blur",message:"标签不能为空"}]},searchInput:"",applyRes:!1}},mounted:function(){var e=this;this.emptyText="正在加载...",c.list().then((function(t){e.certificates=t.map((function(e){return e=JSON.parse(e),e.certificate["absSignature"]=e.absSignature,e.certificate})),e.emptyText="暂无证书"})).catch(console.log)},methods:{detailInfo:function(e){this.detailVisible=!0,this.detail=e},revoke:function(e){var t=this,i=e.row.serialNumber;c.revoke({no:i}).then((function(i){"OK."===i?(t.$message({message:"撤销成功",duration:2e3,type:"success"}),t.certificates.splice(e.$index,1)):t.$message({message:i,type:"error"})})).catch((function(e){t.$message({message:e.message,type:"error"})}))},applyForCert:function(){var e=this;this.$refs.applyForm.validate((function(t){if(t){var i=e.applyCert,a=i.uid,r=i.attribute;e.applyRes=!1,c.apply(a,r).then((function(t){t.certificate["absSignature"]=t.absSignature,e.applyRes=t.certificate,e.$message({message:"申请成功",duration:2e3,type:"success"})})).catch((function(t){e.$message({message:t.message,type:"error"})}))}}))},searchCert:function(){var e=this,t=this.searchInput;t&&c.certInfo(t).then((function(t){t.certificate["absSignature"]=t.absSignature,e.certificates=[t.certificate]})).catch((function(t){e.$message({message:t.message,type:"error"})}))}}},p=u,m=(i("a984"),i("52e0")),f=Object(m["a"])(p,a,r,!1,null,"48a73b44",null);t["default"]=f.exports},a984:function(e,t,i){"use strict";i("2bbb")},fb4a:function(e,t,i){"use strict";var a=i("ea90"),r=i("3ee6"),s=i("84a7"),l=i("c352"),n=i("06b9"),o=i("5786"),c=i("2efa"),u=i("294d"),p=i("9140"),m=p("splice"),f=r.TypeError,d=Math.max,b=Math.min,v=9007199254740991,y="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!m},{splice:function(e,t){var i,a,r,p,m,h,g=o(this),_=n(g),w=s(e,_),C=arguments.length;if(0===C?i=a=0:1===C?(i=0,a=_-w):(i=C-2,a=b(d(l(t),0),_-w)),_+i-a>v)throw f(y);for(r=c(g,a),p=0;p<a;p++)m=w+p,m in g&&u(r,p,g[m]);if(r.length=a,i<a){for(p=w;p<_-a;p++)m=p+a,h=p+i,m in g?g[h]=g[m]:delete g[h];for(p=_;p>_-a+i;p--)delete g[p-1]}else if(i>a)for(p=_-a;p>w;p--)m=p+a-1,h=p+i-1,m in g?g[h]=g[m]:delete g[h];for(p=0;p<i;p++)g[p+w]=arguments[p+2];return g.length=_-a+i,r}})}}]);
//# sourceMappingURL=chunk-4c77bea4.f9bda6b2.js.map